# 랭킹 모바일 페이지 동기화 기획서

> 작성일: 2026-01-21
> 목적: PC 랭킹 페이지와 모바일 랭킹 페이지 기능 동기화

---

## 1. 현재 상태 분석

### 1.1 PC 버전 (`/ranking/*`)
- **상태**: 완전한 기능 구현 완료
- **구조**:
  - `/ranking` → `/ranking/noa`로 리다이렉트
  - `/ranking/noa` - HITON 전투력 랭킹
  - `/ranking/cp` - 전투력 랭킹
  - `/ranking/content` - 콘텐츠 랭킹
- **핵심 컴포넌트**: `RankingTable.tsx`
- **주요 기능**:
  - 랭킹 테이블 (무한 스크롤/페이지네이션)
  - 서버/종족 필터
  - 순위 변동 표시 (상승/하락/유지/신규)
  - 캐릭터 상세 링크
  - PVE/PVP 점수 표시
  - 아이템 레벨 표시

### 1.2 모바일 버전 (`/components/mobile/RankingMobile.tsx`)
- **상태**: **거의 완전 구현** (API 연동 완료)
- **코드량**: 약 267줄
- **데이터 연동**: `/api/ranking` API 사용
- **주요 기능**:
  - 랭킹 리스트 (더보기 버튼)
  - 서버/종족 필터
  - 랭킹 타입 전환 (HITON/콘텐츠)
  - 캐릭터 상세 링크
  - PVE/PVP 점수 표시
  - 스켈레톤 로딩

---

## 2. 동기화 필요 기능 목록

### 2.1 랭킹 데이터 조회

| 기능 | PC 구현 | 모바일 현황 | 우선순위 |
|------|---------|-------------|----------|
| API 연동 | `/api/ranking` | `/api/ranking` | **동기화 완료** |
| 페이지네이션 | O (무한 스크롤) | O (더보기 버튼) | **동기화 완료** |
| 로딩 상태 | 스켈레톤 | 스켈레톤 | **동기화 완료** |
| 빈 상태 | O | O | **동기화 완료** |

### 2.2 필터 기능

| 기능 | PC 구현 | 모바일 현황 | 우선순위 |
|------|---------|-------------|----------|
| 서버 필터 | O (전체/지켈/이스라펠/아트레이아) | O | **동기화 완료** |
| 종족 필터 | O (전체/천족/마족) | O | **동기화 완료** |
| 필터 변경 시 리셋 | O | O | **동기화 완료** |

### 2.3 랭킹 타입

| 기능 | PC 구현 | 모바일 현황 | 우선순위 |
|------|---------|-------------|----------|
| HITON 전투력 | `/ranking/noa` | O (탭) | **동기화 완료** |
| 전투력 (CP) | `/ranking/cp` | X (미구현) | P1 |
| 콘텐츠 랭킹 | `/ranking/content` | O (탭) | **동기화 완료** |
| 타입 전환 | URL 라우팅 | 탭 버튼 | **동기화 완료** |

### 2.4 캐릭터 정보 표시

| 기능 | PC 구현 | 모바일 현황 | 우선순위 |
|------|---------|-------------|----------|
| 순위 배지 | O (1~3위 특별) | O (1~3위 특별) | **동기화 완료** |
| 프로필 이미지 | O | O | **동기화 완료** |
| 캐릭터명 | O | O | **동기화 완료** |
| 서버/종족/클래스 | O | O | **동기화 완료** |
| PVE 점수 | O (녹색) | O (녹색) | **동기화 완료** |
| PVP 점수 | O (빨강) | O (빨강) | **동기화 완료** |
| 아이템 레벨 | O | X | P2 |
| 상세 페이지 링크 | O | O | **동기화 완료** |

### 2.5 순위 변동

| 기능 | PC 구현 | 모바일 현황 | 우선순위 |
|------|---------|-------------|----------|
| 순위 상승 표시 | O (TrendingUp) | X | P1 |
| 순위 하락 표시 | O (TrendingDown) | X | P1 |
| 순위 유지 표시 | O (Minus) | X | P1 |
| 신규 진입 표시 | O (Sparkles) | X | P1 |
| 변동폭 수치 | O | X | P1 |

### 2.6 UI/UX

| 기능 | PC 구현 | 모바일 현황 | 우선순위 |
|------|---------|-------------|----------|
| 테이블 레이아웃 | 테이블 | 리스트 | 모바일 최적화 (유지) |
| 스켈레톤 로딩 | O | O | **동기화 완료** |
| 더보기/무한스크롤 | 무한 스크롤 | 더보기 버튼 | 모바일 최적화 (유지) |
| 하단 여백 (광고) | X | O | 모바일 전용 (유지) |

---

## 3. 동기화 상태 요약

### 3.1 완료된 항목 (동기화 불필요)

| 기능 | 상태 |
|------|------|
| 랭킹 API 연동 | ✅ 완료 |
| 서버/종족 필터 | ✅ 완료 |
| HITON/콘텐츠 탭 | ✅ 완료 |
| 캐릭터 정보 표시 | ✅ 완료 |
| PVE/PVP 점수 | ✅ 완료 |
| 스켈레톤 로딩 | ✅ 완료 |
| 상세 페이지 링크 | ✅ 완료 |
| 페이지네이션 | ✅ 완료 |

### 3.2 동기화 필요 항목

| 기능 | 우선순위 | 복잡도 |
|------|----------|--------|
| 순위 변동 표시 | **P1** | 중 |
| CP 랭킹 타입 | P1 | 낮음 |
| 아이템 레벨 표시 | P2 | 낮음 |

---

## 4. 기술적 구현 방안

### 4.1 순위 변동 표시 추가

```tsx
// RankingMobile.tsx에 추가

// 1. 순위 변동 타입 정의
interface RankChange {
  type: 'up' | 'down' | 'same' | 'new'
  amount?: number
}

// 2. 순위 변동 계산 함수 (PC 로직 재사용)
const getRankChange = (currentRank: number, prevRank?: number | null): RankChange => {
  if (prevRank === null || prevRank === undefined) return { type: 'new' }
  if (prevRank === currentRank) return { type: 'same' }
  if (prevRank > currentRank) return { type: 'up', amount: prevRank - currentRank }
  return { type: 'down', amount: currentRank - prevRank }
}

// 3. 변동 표시 컴포넌트
const RankChangeIndicator = ({ change }: { change: RankChange }) => {
  switch (change.type) {
    case 'up':
      return <span className={styles.rankUp}>▲{change.amount}</span>
    case 'down':
      return <span className={styles.rankDown}>▼{change.amount}</span>
    case 'new':
      return <span className={styles.rankNew}>NEW</span>
    default:
      return <span className={styles.rankSame}>-</span>
  }
}
```

### 4.2 CP 랭킹 타입 추가

```tsx
// typeTabs에 CP 추가
<div className={styles.typeTabs}>
  <button onClick={() => handleTypeChange('hiton')}>HITON</button>
  <button onClick={() => handleTypeChange('cp')}>전투력</button>  {/* 추가 */}
  <button onClick={() => handleTypeChange('content')}>콘텐츠</button>
</div>

// handleTypeChange 수정
const handleTypeChange = (newType: 'hiton' | 'cp' | 'content') => {
  setActiveType(newType)
  const routes = {
    hiton: '/ranking/noa',
    cp: '/ranking/cp',
    content: '/ranking/content'
  }
  router.push(routes[newType])
}
```

### 4.3 아이템 레벨 표시 추가

```tsx
// 캐릭터 정보에 아이템 레벨 추가
<div className={styles.charMeta}>
  <span>{SERVER_MAP[char.server_id]}</span>
  <span className={styles.dot}>·</span>
  <span>{char.class_name}</span>
  {char.item_level && (
    <>
      <span className={styles.dot}>·</span>
      <span className={styles.itemLevel}>iLv.{char.item_level}</span>
    </>
  )}
</div>
```

---

## 5. 구현 단계 (Phase)

### Phase 1: 기능 동등성 (P1)
**목표**: PC와 동일한 정보 표시

1. 순위 변동 표시 추가
   - 상승/하락/유지/신규 아이콘
   - 변동폭 수치 표시
   - CSS 스타일링

2. CP 랭킹 타입 추가
   - 탭 버튼 추가
   - 라우팅 연결

### Phase 2: 세부 정보 (P2)
**목표**: 추가 정보 표시

1. 아이템 레벨 표시
   - API 응답에서 item_level 사용
   - 레이아웃 조정

---

## 6. 주의사항

### 6.1 기존 기능 유지
- PC 버전 코드 수정 금지
- 모바일 최적화 레이아웃 유지 (테이블 → 리스트)
- 더보기 버튼 방식 유지 (무한 스크롤 대신)

### 6.2 API 호환성
- `/api/ranking` 응답에 `prev_rank` 필드 확인 필요
- 없으면 순위 변동 표시 생략

### 6.3 성능 고려
- 불필요한 리렌더링 방지
- 이미지 최적화 유지

---

## 7. 파일 구조

```
/app/
├── ranking/
│   ├── page.tsx              # 리다이렉트 (수정 X)
│   ├── noa/page.tsx          # HITON 랭킹 (수정 X)
│   ├── cp/page.tsx           # CP 랭킹 (수정 X)
│   └── content/page.tsx      # 콘텐츠 랭킹 (수정 X)
├── components/
│   ├── ranking/
│   │   └── RankingTable.tsx  # PC 랭킹 테이블 (수정 X)
│   └── mobile/
│       ├── RankingMobile.tsx       # 모바일 랭킹 (동기화 대상)
│       └── RankingMobile.module.css # 모바일 스타일
```

---

## 8. 예상 작업량

| Phase | 예상 작업 항목 수 | 복잡도 |
|-------|------------------|--------|
| Phase 1 | 2개 (순위 변동, CP 타입) | 중 |
| Phase 2 | 1개 (아이템 레벨) | 낮음 |

**총 예상 작업량**: 3개 항목

---

## 9. 결론

**랭킹 모바일 페이지는 대부분 동기화가 완료된 상태입니다.**

| 항목 | 동기화 완료 | 미완료 |
|------|------------|--------|
| 핵심 기능 | 8개 | 0개 |
| 부가 기능 | 0개 | 3개 |

**미완료 항목**:
1. 순위 변동 표시 (P1) - 상승/하락/신규 아이콘
2. CP 랭킹 타입 (P1) - 탭 버튼 추가
3. 아이템 레벨 (P2) - 추가 정보

---

*본 기획서는 기능 동기화 작업의 범위와 방향을 정의합니다.*
