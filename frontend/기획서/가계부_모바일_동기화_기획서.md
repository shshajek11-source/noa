# 가계부 모바일 페이지 동기화 기획서

> 작성일: 2026-01-21
> 목적: PC 가계부 페이지와 모바일 가계부 페이지 기능 동기화

---

## 1. 현재 상태 분석

### 1.1 PC 버전 (`/ledger/page.tsx`)
- **상태**: 완전한 기능 구현 완료
- **코드량**: 약 1,166줄
- **데이터 연동**: Supabase 실시간 연동
- **인증**: Google 로그인 + device_id 기반

### 1.2 모바일 버전 (`/ledger/mobile/page.tsx`)
- **상태**: UI 목업만 존재 (하드코딩된 더미 데이터)
- **코드량**: 약 704줄
- **데이터 연동**: 없음
- **인증**: 없음

---

## 2. 동기화 필요 기능 목록

### 2.1 인증 및 초기화

| 기능 | PC 구현 | 모바일 현황 | 우선순위 |
|------|---------|-------------|----------|
| Google 로그인 | O | X | **P0** |
| device_id 인증 | O | X | **P0** |
| 로그인 필수 화면 | O | X | **P0** |
| 모바일 감지 리다이렉트 | O (PC→모바일) | X | P2 |

### 2.2 캐릭터 관리

| 기능 | PC 구현 | 모바일 현황 | 우선순위 |
|------|---------|-------------|----------|
| 캐릭터 목록 조회 | `useLedgerCharacters` | 하드코딩 | **P0** |
| 캐릭터 추가 (검색/등록) | `AddCharacterModal` | X | **P1** |
| 캐릭터 삭제 | O | X | **P1** |
| 캐릭터 탭 전환 | `LedgerTabs` | 하드코딩 | **P0** |
| 캐릭터 상태 로드/저장 | `/api/ledger/character-state` | X | **P0** |

### 2.3 대시보드 (총합 탭)

| 기능 | PC 구현 | 모바일 현황 | 우선순위 |
|------|---------|-------------|----------|
| 전체 수입 통계 | `DashboardSummary` | 하드코딩 | **P1** |
| 캐릭터별 수입 현황 | O | X | **P1** |
| 미판매 아이템 현황 | O | 하드코딩 | **P1** |
| 등급별 아이템 수량 | O | X | P2 |

### 2.4 컨텐츠 관리 (숙제)

#### 2.4.1 주간 컨텐츠
| 기능 | PC 구현 | 모바일 현황 | 우선순위 |
|------|---------|-------------|----------|
| 사명 진행 체크 | `WeeklyContentSection` | UI만 존재 | **P0** |
| 주간 지령서 | O | UI만 존재 | **P0** |
| 어비스 주간 지령서 | O | UI만 존재 | **P0** |
| 슈고 페스타 | O | UI만 존재 | **P0** |
| 어비스 회랑 | O | UI만 존재 | **P0** |

#### 2.4.2 던전 컨텐츠
| 기능 | PC 구현 | 모바일 현황 | 우선순위 |
|------|---------|-------------|----------|
| 초월 던전 기록 | `DungeonContentSection` | UI만 존재 | **P0** |
| 원정 던전 기록 | O | UI만 존재 | **P0** |
| 성역 던전 기록 | O | UI만 존재 | **P0** |
| 던전 선택 (보스/단계) | O | UI만 존재 | **P1** |
| 오드 에너지 2배 사용 | O | UI만 존재 | **P1** |
| 진행 기록 로그 | O | UI만 존재 | **P1** |
| 기록 삭제 | O | X | **P1** |

#### 2.4.3 일일 컨텐츠
| 기능 | PC 구현 | 모바일 현황 | 우선순위 |
|------|---------|-------------|----------|
| 일일 던전 | `DailyContentSection` | UI만 존재 | **P0** |
| 각성전 | O | UI만 존재 | **P0** |
| 악몽 | O | UI만 존재 | **P0** |
| 차원침공 | O | UI만 존재 | **P0** |
| 토벌전 | O | UI만 존재 | **P0** |

### 2.5 티켓 및 오드 에너지

| 기능 | PC 구현 | 모바일 현황 | 우선순위 |
|------|---------|-------------|----------|
| 티켓 잔여량 표시 | O | 하드코딩 | **P0** |
| 티켓 보너스 충전 | `TicketChargePopup` | X | **P1** |
| 오드 에너지 표시 | `OdEnergyBar` | 하드코딩 | **P0** |
| 오드 에너지 충전 | O | X | **P1** |
| 오드 에너지 차감/복구 | O | X | **P1** |
| 초기설정 동기화 | O | X | **P1** |

### 2.6 아이템 관리

| 기능 | PC 구현 | 모바일 현황 | 우선순위 |
|------|---------|-------------|----------|
| 아이템 목록 조회 | `useLedgerItems` | 하드코딩 | **P0** |
| 아이템 추가 | `AddItemModal` | X | **P1** |
| 아이템 판매 처리 | O | X | **P1** |
| 아이템 판매 취소 | O | X | P2 |
| 아이템 삭제 | O | X | P2 |
| 아이템 검색 | O | UI만 존재 | P2 |
| 즐겨찾기 기능 | `useFavoriteItems` | UI만 존재 | P2 |
| 판매 내역 로그 | O | UI만 존재 | P2 |

### 2.7 날짜 및 통계

| 기능 | PC 구현 | 모바일 현황 | 우선순위 |
|------|---------|-------------|----------|
| 게임 날짜 기준 (05시) | `getGameDate` | X | **P0** |
| 날짜 선택 (캘린더) | `CalendarModal` | X | **P1** |
| 일일/주간 수입 표시 | `BottomNavBar` | 하드코딩 | **P0** |
| 충전 타이머 표시 | O | 하드코딩 | **P1** |

### 2.8 UI 컴포넌트

| 기능 | PC 구현 | 모바일 현황 | 우선순위 |
|------|---------|-------------|----------|
| 하단 네비게이션 바 | `BottomNavBar` | X | **P1** |
| 이용 가이드 모달 | O | X | P2 |
| 디버그 패널 | X (모바일 불필요) | X | - |

---

## 3. 기술적 구현 방안

### 3.1 공유 가능한 기존 리소스

#### Hooks (재사용)
```
/ledger/hooks/
├── useDeviceId.ts        → 모바일에서 동일하게 사용
├── useLedgerCharacters.ts → 모바일에서 동일하게 사용
├── useContentRecords.ts   → 모바일에서 동일하게 사용
├── useLedgerItems.ts      → 모바일에서 동일하게 사용
├── useFavoriteItems.ts    → 모바일에서 동일하게 사용
├── useWeeklyStats.ts      → 모바일에서 동일하게 사용
└── useDailyContent.ts     → 모바일에서 동일하게 사용
```

#### Utils (재사용)
```
/ledger/utils/
└── dateUtils.ts           → 모바일에서 동일하게 사용
```

#### Context (재사용)
```
/context/
└── AuthContext.tsx        → 모바일에서 동일하게 사용
```

### 3.2 모바일 전용 컴포넌트 (신규 생성 필요)

```
/ledger/mobile/components/
├── MobileCharacterList.tsx     # 캐릭터 스토리 스타일 목록
├── MobileCharacterCard.tsx     # 캐릭터 카드 (접힘/펼침)
├── MobileContentCard.tsx       # 컨텐츠 진행 카드
├── MobileDungeonCard.tsx       # 던전 기록 카드 (초월/원정/성역)
├── MobileItemList.tsx          # 아이템 목록
├── MobileAddCharacterModal.tsx # 캐릭터 추가 모달
├── MobileTicketChargeModal.tsx # 티켓 충전 모달
└── MobileCalendarModal.tsx     # 날짜 선택 모달
```

### 3.3 API 엔드포인트 (기존 사용)

모든 API는 PC와 동일하게 사용:
- `/api/ledger/characters` - 캐릭터 CRUD
- `/api/ledger/character-state` - 캐릭터 상태 (티켓/오드)
- `/api/ledger/dungeon-records` - 던전 기록
- `/api/ledger/weekly-content` - 주간 컨텐츠
- `/api/ledger/items` - 아이템 CRUD
- `/api/ledger/stats` - 통계 조회
- `/api/ledger/content-records` - 컨텐츠 기록

---

## 4. 구현 단계 (Phase)

### Phase 1: 핵심 인프라 (P0)
**목표**: 데이터 연동 및 기본 기능 작동

1. 인증 시스템 연동
   - `useAuth`, `useDeviceId` 훅 연결
   - 로그인 필수 화면 구현

2. 캐릭터 관리 연동
   - `useLedgerCharacters` 훅 연결
   - 캐릭터 목록 실데이터 표시
   - 캐릭터 탭 전환 기능

3. 날짜 시스템 연동
   - `getGameDate` 유틸 적용
   - 날짜 표시 실데이터 연결

### Phase 2: 컨텐츠 기능 (P0~P1)
**목표**: 숙제 체크 기능 완전 작동

1. 주간 컨텐츠 연동
   - 사명/지령서/슈고페스타 등
   - `useContentRecords` 또는 전용 API 연결

2. 던전 컨텐츠 연동
   - 초월/원정/성역 기록
   - 던전 선택/단계 선택 기능
   - 기록 추가/삭제 기능

3. 일일 컨텐츠 연동
   - 일일던전/각성전/악몽/차원침공/토벌전

4. 티켓/오드 에너지 연동
   - 잔여량 표시
   - 충전 기능

### Phase 3: 아이템 및 통계 (P1~P2)
**목표**: 수입 관리 기능 완성

1. 아이템 관리 연동
   - `useLedgerItems` 훅 연결
   - 아이템 추가/판매/삭제

2. 대시보드 통계 연동
   - 전체 수입 표시
   - 캐릭터별 현황

3. 캘린더/날짜 선택
   - 날짜별 데이터 조회

### Phase 4: 부가 기능 (P2)
**목표**: 사용성 개선

1. 즐겨찾기 기능
2. 아이템 검색
3. 이용 가이드
4. UI/UX 개선

---

## 5. 주의사항

### 5.1 기존 기능 유지
- PC 버전 코드 수정 금지
- API 엔드포인트 변경 금지
- 공유 hooks 로직 변경 시 PC 영향도 검토

### 5.2 모바일 특성 고려
- 터치 인터랙션 최적화
- 화면 크기에 맞는 레이아웃
- 애드센스 광고 영역 확보 (하단 여백)

### 5.3 데이터 일관성
- PC와 모바일 동일 데이터 표시
- 실시간 동기화 (같은 API 사용)
- 오프라인 처리 고려 (선택사항)

---

## 6. 파일 구조 (예상)

```
/ledger/
├── page.tsx                    # PC 버전 (수정 X)
├── ledger.module.css           # PC 스타일
├── hooks/                      # 공유 훅 (수정 X)
├── utils/                      # 공유 유틸 (수정 X)
├── components/                 # PC 컴포넌트 (수정 X)
└── mobile/
    ├── page.tsx                # 모바일 버전 (동기화 대상)
    ├── MobileLedger.module.css # 모바일 스타일
    ├── layout.tsx              # 모바일 레이아웃
    └── components/             # 모바일 전용 컴포넌트 (신규)
        ├── MobileCharacterList.tsx
        ├── MobileCharacterCard.tsx
        ├── MobileContentCard.tsx
        ├── MobileDungeonCard.tsx
        ├── MobileItemList.tsx
        └── ... (필요시 추가)
```

---

## 7. 예상 작업량

| Phase | 예상 작업 항목 수 | 복잡도 |
|-------|------------------|--------|
| Phase 1 | 8개 | 중 |
| Phase 2 | 15개 | 높음 |
| Phase 3 | 10개 | 중 |
| Phase 4 | 5개 | 낮음 |

---

## 8. 참고 파일

### PC 버전 주요 파일
- `src/app/ledger/page.tsx` - 메인 페이지
- `src/app/ledger/components/DungeonContentSection.tsx` - 던전 컨텐츠
- `src/app/ledger/components/WeeklyContentSection.tsx` - 주간 컨텐츠
- `src/app/ledger/components/DailyContentSection.tsx` - 일일 컨텐츠
- `src/app/ledger/components/ItemManagementTab.tsx` - 아이템 관리

### 공유 훅
- `src/app/ledger/hooks/useLedgerCharacters.ts`
- `src/app/ledger/hooks/useContentRecords.ts`
- `src/app/ledger/hooks/useLedgerItems.ts`
- `src/app/ledger/hooks/useFavoriteItems.ts`
- `src/app/ledger/hooks/useWeeklyStats.ts`

---

*본 기획서는 기능 동기화 작업의 범위와 방향을 정의합니다. 새로운 기능 추가는 범위에 포함되지 않습니다.*
