# 프로젝트 소통 - 리팩토링 논의

---

## 1. 장비 탭 문제

### 1-1. 장비 상세보기에서 돌파 옵션 미표시
**현재 상황:**
- 장비 카드: 파란 마름모로 돌파 횟수 표시됨 ✓
- 장비 상세보기: 돌파로 붙은 옵션이 안 나옴 ✗

**필요한 작업:**
- 장비 상세보기에서 돌파 보너스 표시 추가
- 예: 무기 돌파 2단계 → "공격력 +60", "공격력 증가 +2%" 표시

**질문:** 돌파 옵션을 어떤 색상/스타일로 표시할까요? (공식 사이트처럼 파란색?)

---

## 2. 능력치 통합 뷰 문제

### 2-1. 데이터 소스 혼란
- `statsAggregator`가 공식 AION2 API의 복잡한 raw 데이터를 직접 파싱
- `detail._raw.mainStats.extra` 같은 필드의 의미가 불명확
- 강화 보너스를 돌파로 잘못 표시하는 문제 발생

### 2. 돌파(Breakthrough) 관련
- **문제**: `extra` 값을 돌파 보너스로 오해
- **실제**: `extra`는 강화(+15 등) 보너스
- **돌파 조건**: 강화 +15 이상인 장비만 돌파 가능
- **돌파 보너스 공식**:
  - 무기/가더: 공격력 +30, 공격력 증가 +1% (단계당)
  - 방어구: 방어력 +40, 생명력 +40, 방어력 증가 +1% (단계당)
  - 장신구: 공격력 +20, 방어력 +20, 공격력 증가 +1% (단계당)

---

## 제안하는 해결 방향

### 자체 정리된 데이터 사용
```
[현재]
공식 API raw 데이터 → statsAggregator에서 복잡하게 파싱 → 오류 발생

[개선]
장비 탭에서 이미 정리된 데이터 → statsAggregator에서 간단하게 사용 → 정확한 결과
```

### 장비 데이터 구조 (이미 정리됨)
```typescript
{
  slot: "주무기",
  name: "분노한 크로메데의 은장도",
  enhancement: "+15",      // 강화 수치
  breakthrough: 2,         // 돌파 단계 (0이면 돌파 안함)
  // ... 기타 필드
}
```

---

## 논의가 필요한 사항

### Q1. 능력치 출처 표시 방식
현재 툴팁에 표시되는 출처:
- `(기본)` - 장비 기본 스탯
- `(강화)` - 강화로 얻은 추가 스탯
- `(돌파 N단계)` - 돌파로 얻은 스탯
- `(마석)` - 마석에서 얻은 스탯
- `(부옵)` - 랜덤 옵션 스탯

**질문**: 이 표시 방식이 맞나요? 추가하거나 수정할 것이 있나요?

---

### Q2. 어떤 스탯들을 합산해야 하나요?
현재 합산 대상:
- [ ] 장비 기본 스탯 (공격력, 방어력 등)
- [ ] 장비 강화 보너스
- [ ] 장비 돌파 보너스
- [ ] 장비 부옵 (랜덤 옵션)
- [ ] 마석 스탯
- [ ] 타이틀 스탯
- [ ] 대바니온 스탯
- [ ] 기본 스탯 (위력, 민첩 등에서 파생)

**질문**: 빠진 것이나 제외해야 할 것이 있나요?

---

### Q3. 장비 슬롯별 분류
현재 분류:
- **무기/가더**: 주무기, 보조무기(가더 종류)
- **방어구**: 투구, 견갑, 흉갑, 장갑, 각반, 장화, 망토
- **장신구**: 귀걸이, 목걸이, 반지, 벨트, 아뮬렛, 팔찌

**질문**: 이 분류가 맞나요? 누락된 슬롯이 있나요?

---

### Q4. 기타 확인 사항
- 신석(Godstone) 스탯도 합산에 포함해야 하나요?
- 세트 효과(Set Bonus)도 표시해야 하나요?
- 아르카나 스탯은 어떻게 처리하나요?

---

## 작업 계획 (논의 후 진행)

1. [ ] 위 질문들 확정
2. [ ] statsAggregator 리팩토링 - 자체 정리된 데이터 사용
3. [ ] 테스트 및 검증
4. [ ] 디버그 패널 제거

---

## 메모/기록

### 2025-01-07
- 문서 생성
- 돌파/강화 혼동 문제 발견 및 임시 수정

---

*이 문서는 리팩토링 진행 전 소통을 위한 것입니다. 질문에 답변해주시면 작업을 진행하겠습니다!*
