# 프로젝트 소통 - 능력치 계산 시스템

## 📋 현재 논의 사항

### ✅ 능력치 통합 및 퍼센트 증가 적용 - 구현 완료

**요청사항**: 비슷한 능력치들은 하나로 묶어서 더하고 증가하는 퍼센트를 적용

**🎉 구현 완료된 기능**:
- ✅ 능력치 그룹화: 생명력, 공격력, 방어력, 정신력
- ✅ 데이터 파싱: `statSecondList`에서 퍼센트 증가 추출
- ✅ 통합 계산: (기본+추가) × (1+퍼센트) = 최종 능력치
- ✅ 실제 데이터 테스트 완료 및 검증
- ✅ 분리 방식으로 기존 시스템과 별도 구현

#### 🤔 구체적으로 어떤 능력치들을 묶어야 할까요?

예를 들어:
- **물리 공격력** 관련: 기본 물리 공격력 + 추가 물리 공격력 → 통합 후 퍼센트 적용
- **마법 공격력** 관련: 기본 마법 공격력 + 추가 마법 공격력 → 통합 후 퍼센트 적용
- **방어력** 관련: 기본 방어력 + 추가 방어력 → 통합 후 퍼센트 적용
- **체력/관련**: 기본 체력 + 추가 체력 → 통합 후 퍼센트 적용

#### 🎯 적용 순서 제안
1. **기본 능력치** + **추가 능력치** = **기본 합계**
2. **기본 합계** × (1 + **퍼센트 증가**) = **최종 능력치**

#### 💭 질문 사항
1. 어떤 능력치들을 그룹화해야 할까요? 생명력,공격력,방어력,정신력 능력치야
2. 퍼센트 증가 능력치들은 어떤 형식으로 데이터에 들어있나요? (예: "생명력증가 아래에 수치가 나와있음 ,방어력,공격력도 마찬가지 %")
3. 이런 퍼센트 능력치들은 장비, 버프, 칭호 등 어디서 오나요? 캐릭에 반영되는 모든 요소들에서 나옵니다. 우리 웹사이트에 나와있습니다.
4. 계산은 최종 표시용만 필요한가요, 아니면 중간 계산 과정도 보여줘야 하나요? 과정은 생략하고 해당 능력치의 결과 수치만 보여주면됩니다.

---

## 📝 작업 로그

### [2025-01-07] 능력치 통합 계산 구현 완료 ✅
- ✅ 데이터 파싱 함수 구현 (`statSecondList`에서 퍼센트 추출)
- ✅ 능력치 그룹화 로직 구현 (생명력, 공격력, 방어력, 정신력)
- ✅ 통합 계산 공식 구현: (기본+추가) × (1+퍼센트) = 최종
- ✅ 실제 데이터 테스트 성공
- 🔄 기존 statBonusCalculator.ts와 통합 방안 논의 필요

### [2025-01-07] 능력치 계산 논의 시작
- 비슷한 능력치 통합 및 퍼센트 적용 요청
- 구체적 그룹화 방법 논의 필요

---

## 💡 아이디어 노트

**핵심 이해완료**: 내가 말하는 증가는 능력치 총합의 0.0% 증가라는 능력치의 퍼센트를 적용해 해당 능력치에 반영하는 것을 의미함

**예시 계산**:
- 기본 물리 공격력: 800
- 추가 물리 공격력: 200
- 물리 공격력 증가: 10%
- **최종 물리 공격력**: (800 + 200) × 1.10 = 1100

**구현 방법 제안**:
1. 같은 속성 능력치들끼리 그룹화 (기본 + 추가 = 기본 합계)
2. 퍼센트 증가 능력치가 있는지 확인
3. 기본 합계 × (1 + 퍼센트/100) = 최종 능력치

## 🔍 데이터 구조 발견

**실제 API 데이터 형식** (`debug_api.json`):
```json
{
  "stats": {
    "statList": [
      {
        "type": "STR",
        "name": "위력",
        "value": 129,
        "statSecondList": ["공격력 증가 +12.9%"]
      },
      {
        "type": "CON", 
        "name": "체력",
        "value": 77,
        "statSecondList": ["생명력 증가 +7.7%"]
      }
    ]
  }
}
```

## 🎯 구현 결과

### 📁 생성된 파일
- **`frontend/src/lib/consolidatedStatCalculator.ts`**: 새로운 통합 계산 시스템
- **`frontend/test-consolidated-stats.js`**: 테스트 파일 (삭제 가능)

### 🔧 사용 방법
```typescript
import { ConsolidatedStatCalculator } from '@/lib/consolidatedStatCalculator'

// 통합 능력치 계산
const results = ConsolidatedStatCalculator.calculateConsolidatedStats(statList)

// 개별 능력치 계산  
const result = ConsolidatedStatCalculator.calculateIndividualStat(stat)
```

### 📊 테스트 결과 예시
```
생명력:
  기본값: 148 (체력 77 + 생명력[유스티엘] 71)
  최종값: 180 (21.9% 증가 적용)
  공식: 148 × (1 + 21.9%) = 180

공격력:
  기본값: 129 (위력)
  최종값: 145 (12.9% 증가 적용)  
  공식: 129 × (1 + 12.9%) = 145
```

## 🔗 관련 파일
- ✅ **새 계산기**: `frontend/src/lib/consolidatedStatCalculator.ts`
- **기존 계산기**: `frontend/src/lib/statBonusCalculator.ts` (유지)
- **데이터 예시**: `frontend/debug_api.json`
- **능력치 컴포넌트**: `frontend/components/character/`